<head>
  <title>CS249EventsApp</title>
</head>

<body>
    <div class="navbar navbar-default" role="navigation">
		<div class="navbar-header">
			<a class="navbar-brand" id="home">Events Organizer</a>
		</div>
		<div class="navbar-collapse collapse">
			{{#if currentUser}}
            <a class="navbar-brand" id="addEvents">Add an Event</a>
			<a class="navbar-brand" id="attendEvent">Attend an Event</a>
            <a class="navbar-brand" id="quickhelp">Quick Help</a>
            <a class="navbar-brand" id="schedule">Schedule</a>
            {{/if}}
			<ul class="nav navbar-nav navbar-right">
				{{> loginButtons}} <!-- here -->
			</ul>
		</div>
	</div>
    
    {{#if homePage}}
    {{> home}}
    {{/if}}
    
    {{#if quickHelpPage}}
    {{> quickHelp}}
    {{/if}}
    
    {{#if schedulePage}}
    {{> schedule}}
    {{/if}}
	
	{{#if addEventsPage}}
	{{> addEvents}}
	{{/if}}
	
	{{#if attendEventPage}}
	{{> attendEvent}}
	{{/if}}
</body>

<template name="plsLogin">
	<div>You need to log in</div>
</template>

<template name="home">
	<div> HOME PAGE</div>
</template>

<template name="currentEvent">
	{{#if isNull}}
	<div class="alert alert-danger margin">
		<h4>Please <a class="alert-link" id="attendEvent">select an event to attend</a></h4>
	</div>	
	{{else}}
	<div class="alert alert-success margin">
		<h4>Event: {{currentEvent}}</h4>
	</div>
	{{/if}}
</template>

<template name="quickHelp">
    {{#if currentUser}}
	{{> currentEvent}}
    <section>
		<div class="padding">
			<form class="new-thread form-horizontal" style="padding-bottom: 40px !important;">
					<input class="form-control input-lg" type="text" name="thread" placeholder="Ask a question" />
			</form>
            <ul>
              {{#each threads}}
                {{> oneThread}}
              {{/each}}
            </ul>
		</div>
    </section>
	{{else}}
	{{> plsLogin}}	
	{{/if}}
</template>
    
<template name="oneThread">
    {{#if currentUser}}
        <div class="list-group">
            <li class="list-group-item {{#if active}}active{{else}}oldQuestion{{/if}} {{#if newQ}}newQuestion{{/if}}">
                {{text}}  
                <button type="button" class="close done">✓</button>
                <button type="button" class="close delete">×</button>
            </li>
            {{#each responses}}
                <li class="list-group-item">{{this}}</li>
            {{/each}}
            <li class="list-group-item">
                <form class="new-response form-horizontal">
                    <input class="form-control" type="text" name="response" placeholder="Type to reply" />
                </form>
            </li>
        </div>
	{{else}}
	{{> plsLogin}}
    {{/if}}
</template>

<template name="schedule">
	{{#if currentUser}}
	{{> currentEvent}}
    <table class="table table-striped table-hover col-md-12">
        <thead>
            <tr>
                <td>Time</td>
                <td>Event</td>
                <td>Location<!-- <button type="button" class="add close blue">+</button> --></td>
            </tr>
        </thead>
        <tbody>
			<tr class="info">
				<td style="width: 20%;">
					<div class='input-group date' id='datepicker'>
					<input type='text' class="form-control" name="datepicker" id="dateinput"/>
					<span class="input-group-addon">
						<span class="glyphicon glyphicon-calendar"></span>
					</span>
					</div>
					<script type="text/javascript">
						$(function () {
							$('#datepicker').datetimepicker();
						});
					</script>
				</td>
				<td style="width: 40%;">
					<input type="text" class="form-control" id="inputEvent" name="inputEvent" placeholder="Event">
				</td>
				<td style="width: 35%;">
					<input type="text" class="form-control" id="inputLocation" name="inputLocation" placeholder="Location">
				</td>
				<td style="width: 5%;">
					<button type="button" class="add close blue">+</button>
				</td>
			</tr>
			{{#each calendar}}
			<tr>
				<td>{{timeDateString}}</td>
				<td>{{this.event}}</td>
				<td>{{this.location}}</td>
				<td><button type="button" class="close remove">×</button></td>
			</tr>
			{{/each}}
        </tbody>
    </table>
	{{else}}
	{{> plsLogin}}
	{{/if}}
</template>

<template name="addEvents">
	{{#if currentUser}}
	<div class="col-md-5">
		<form class="form-horizontal well eventsForm">
		<fieldset>
			<legend>Add an Event</legend>
			<div class="form-group">
				<label for="inputName" class="col-lg-3 control-label">Event Name</label>
				<div class="col-lg-9">
					<input type="text" class="form-control" id="inputName" name="eName" placeholder="Event Name">
				</div>
			</div>
			<div class="form-group">
				<label for="textArea" class="col-lg-3 control-label">Event Description</label>
				<div class="col-lg-9">
					<textarea class="form-control" rows="3" id="textArea" name="eDescript"></textarea>
					<span class="help-block">Add a description about your event.</span>
				</div>
			</div>
			<div class="form-group">
				<label for="startTime" class="col-lg-3 control-label">Start Date</label>
				<div class='input-group date col-lg-9' id='startTime'>
					<input type='text' class="form-control" name="startTime"/>
					<span class="input-group-addon">
						<span class="glyphicon glyphicon-calendar"></span>
					</span>
				</div>
			</div>
			<script type="text/javascript">
				$(function () {
					$('#startTime').datetimepicker();
				});
			</script>
			<div class="form-group">
				<label for="endTime" class="col-lg-3 control-label">End Date</label>
				<div class='input-group date col-lg-9' id='endTime'>
					<input type='text' class="form-control" name="endTime" />
					<span class="input-group-addon">
						<span class="glyphicon glyphicon-calendar"></span>
					</span>
				</div>
			</div>
            <div class="form-group">
				<label for="share" class="col-lg-3 control-label">Share With</label>
				<div class="col-lg-9">
					<textarea class="form-control" rows="3" id="share" name="eShare"></textarea>
					<span class="help-block">Add an e-mail to share the event (for multiple people, please separate e-mails with semi-colon).
                    </span>
				</div>
			</div>
			<script type="text/javascript">
				$(function () {
					$('#endTime').datetimepicker();
				});
			</script>
			<div class="form-group">
				<div class="col-lg-10 col-lg-offset-3">
					<button type="reset" class="btn btn-default">Cancel</button>
					<button type="submit" class="btn btn-primary">Submit</button>
				</div>
			</div>
		</fieldset>
		</form>
        
	</div>
				
    <div class="panel-group col-md-7" id="accordion" role="tablist" aria-multiselectable="true">
		<div class="list-group">
			<li class="list-group-item active">Your Events</li>
		</div>
		{{#each events}}
		{{#if createdByUser}}
		<div class="panel panel-default">
			<div class="panel-heading" role="tab">
				<h4 class="panel-title">
				<a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#{{this._id}}" aria-expanded="false" aria-controls="collapseTwo">
					{{this.name}}
					<button type="button" class="close remove">×</button>
				</a>
				</h4>
			</div>
			<div id="{{this._id}}" class="panel-collapse collapse" role="tabpanel">
				<div class="panel-body">
					<strong>Description:</strong> {{this.description}} <br><br>
					<strong>Start Time:</strong> {{this.startTime}} <br><br>
					<strong>End Time:</strong> {{this.endTime}} <br><br>
					<strong>Created by:</strong> {{this.coordinator}} <br><br>
					<strong>Shared with:</strong> {{this.cleanedShare}} <br><br>
				</div>
			</div>
		</div>
		{{/if}}
		{{/each}}
	</div>
	{{else}}
	{{> plsLogin}}
	{{/if}}
</template>

<template name="attendEvent">
	{{#if currentUser}}
	{{> currentEvent}}
	<div class="panel-group margin" id="accordion" role="tablist" aria-multiselectable="true">
		<div class="list-group" style="margin-bottom: 5px !important;">
			<li class="list-group-item active">List of Events</li>
		</div>
		{{#each events}}
		<div class="panel panel-default selectEvent">

			<div class="panel-heading" role="tab">
				<h4 class="panel-title">
				<a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#{{this._id}}" aria-expanded="false" aria-controls="collapseTwo">
					{{this.name}}
				</a>
				</h4>
			</div>
			<div id="{{this._id}}" class="panel-collapse collapse" role="tabpanel">
				<div class="panel-body">
				{{this.description}}
				</div>
			</div>
		</div>
		{{/each}}
	</div>
	
	{{else}}
	{{> plsLogin}}
	{{/if}}
</template>